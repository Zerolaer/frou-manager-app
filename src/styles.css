
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Performance optimizations */
* {
  box-sizing: border-box;
}

html {
  font-display: swap;
}

body {
  font-display: swap;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Critical CSS for above-the-fold content */
.app-shell {
  contain: layout style paint;
}

.content-scroll {
  contain: layout style;
}

/* Optimize animations */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* Reset / base */
*, *::before, *::after { box-sizing: border-box; }
html, body, #root { height: 100%; }
html, body { margin: 0; padding: 0; }
body { 
  @apply bg-gray-100 text-gray-900 font-[Inter]; 
  font-size: 14px; 
  font-weight: 400;
  line-height: 1.5; /* 21px для 14px текста */
}

/* Hide scrollbar */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari and Opera */
}

/* Shell & content */
.app-shell { min-height: 100vh; width: 100vw; }
.content-scroll { flex: 1; }
.card { @apply bg-white rounded-xl p-4 shadow border border-gray-200; }

/* --- Sidebar --- */
.sidebar{ width:240px; transition: width .18s ease; }
.sidebar-collapsed{ width:84px; }
.brand-title{ @apply text-xl font-extrabold tracking-tight text-gray-900; letter-spacing: -0.02em; }
.brand-sub{ @apply text-xs text-gray-500; }
.collapse-btn{ @apply rounded-md p-2 text-gray-600 hover:bg-gray-100 hover:text-gray-900 border border-transparent; }

/* Sidebar links */
.sidebar-link { @apply flex items-center gap-3 px-3 py-2 rounded-lg transition font-medium text-gray-600; }
.sidebar-link:hover { @apply bg-gray-100 text-gray-900; }
.sidebar-link.active { background: #2563eb; color: white; box-shadow: 0 2px 6px rgba(37,99,235,0.4); }
.sidebar-collapsed .sidebar-link { @apply justify-center; }
.sidebar-link.is-collapsed .label{ display:none; }

/* Tables */
table { @apply w-full text-left border-collapse; }
th { @apply text-xs md:text-sm font-semibold text-gray-600 border-b border-gray-200 px-3 md:px-4 py-2; white-space: nowrap; }
td { @apply text-xs md:text-sm text-gray-800 border-b border-gray-100 px-3 md:px-4 py-2; white-space: nowrap; }
tr:hover td { @apply bg-gray-50; }

/* Buttons */
button { @apply rounded-lg px-3 py-1.5 transition font-medium; }
.btn-accent { @apply bg-blue-600 text-white; }
.btn-accent:hover { @apply bg-blue-700; }
.btn-outline { @apply border border-gray-300 text-gray-700 bg-white; }
.btn-outline:hover { @apply bg-gray-50; }

/* Inputs */
input[type='number']::-webkit-outer-spin-button,
input[type='number']::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input[type='number'] { -moz-appearance: textfield; }

/* Ensure table scroll does not cause page scroll */
.table-wrap { @apply overflow-x-auto; }
.table-inner { min-width: 720px; }

/* --- Finance grid tweaks --- */
.cell-name{ display:flex; align-items:center; gap:8px; padding-left:8px; }
.cell-name .chev{
  margin-left:auto;
  width:24px; height:24px;
  display:inline-flex; align-items:center; justify-content:center;
  border-radius:6px; cursor:pointer;
  color:#64748b;
}
.cell-name .chev:hover{ background:#f3f4f6; color:#111827; }
.cell-name .chev svg{ width:16px; height:16px; transition: transform .18s ease; }
.cell-name .chev.open svg{ transform: rotate(90deg); }

.finance-cell:hover{
  background:#f8fafc;
  outline:1px solid #e5e7eb;
  outline-offset:-1px;
}
.finance-cell .cell-btn{
  width:100%; height:100%;
  display:flex; align-items:center; justify-content:center;
  padding:6px 4px; border-radius:0;
}
.finance-grid{ overflow-x:hidden; }

/* --- Tasks tweaks --- */
.week-head{
  grid-column: 1 / -1;
  padding: 0; /* без вертикальных отступов */
  background: #fff;
}

/* --- Finance scroll fix (final) --- */
/* Скроллим ВНЕШНИЙ контейнер контента только на странице Финансы */
.finance-mode .content-scroll{
  height: calc(100vh - 172px); /* Header (64px) + SubHeader (80px) + Bottom padding (24px) + Extra margin (4px) = 172px */
  overflow-y: auto !important;
}

/* Никаких overflow:visible для Finance — иначе скролл прячется */

/* Скрыть скроллбар на странице Финансов, но оставить прокрутку */
.finance-mode .content-scroll {
  scrollbar-width: none;      /* Firefox */
  -ms-overflow-style: none;   /* IE/Edge */
}

.finance-mode .content-scroll::-webkit-scrollbar {
  display: none;              /* Chrome, Safari, Opera */
}



/* --- Force light background (defensive override) --- */
html, body, #root {
  background-color: #ffffff !important;
  background-image: none !important;
}

/* UI Components from ui.css */
:root{
  --primary:#2563eb;
  --primary-hover:#1d4ed8;
  --danger:#dc2626;
  --danger-hover:#b91c1c;
  --ring:rgba(37,99,235,.15);
}

/* Buttons */
:root button.btn:not(.btn-outline):not(.btn-danger), :root .btn:not(.btn-outline):not(.btn-danger){
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  padding:12px 16px; font-size:13px; line-height:1; border-radius:8px;
  border:1px solid transparent; background-color:var(--primary) !important; color:#fff !important;
  transition:background-color .14s ease, box-shadow .14s ease;
}
:root button.btn:not(.btn-outline):not(.btn-danger):hover, :root .btn:not(.btn-outline):not(.btn-danger):hover{ background-color:var(--primary-hover) !important; }
:root button.btn:focus, :root .btn:focus { outline:none; box-shadow:0 0 0 3px var(--ring); }
:root button.btn.btn-outline, :root .btn.btn-outline{ background-color:#fff !important; color:#111827 !important; border-color:#d1d5db !important; }
:root button.btn.btn-outline:hover, :root .btn.btn-outline:hover{ background-color:#f3f4f6 !important; }
:root button.btn.btn-danger, :root .btn.btn-danger{ background-color:var(--danger) !important; border-color:var(--danger) !important; color:#fff !important; }
:root button.btn.btn-danger:hover, :root .btn.btn-danger:hover{ background-color:var(--danger-hover) !important; }

/* Modals */
.modal-backdrop{
  position:fixed; inset:0; width:100vw; height:100vh;
  background:rgba(15,23,42,.35);
  backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
  z-index:1000;
}
@keyframes modal-pop { 0%{ transform:translate(-50%,-50%) scale(.96); opacity:0; } 100%{ transform:translate(-50%,-50%) scale(1); opacity:1; } }
.modal-card{
  position:fixed; left:50%; top:50%; transform:translate(-50%,-50%);
  z-index:1001; width:450px; max-width:calc(100vw - 32px);
  background:#fff; border-radius:16px; box-shadow:0 24px 64px rgba(0,0,0,.18); overflow:hidden;
  animation: modal-pop .18s ease-out;
}
.modal-card.lg{ width:min(960px, calc(100vw - 32px)); }
.modal-header,.modal-footer{ padding:16px 20px; background:#fff; }
.modal-header{ font-size:14px; font-weight:600; }
.modal-divider{ height:1px; background:#e5e7eb; }
.modal-body{ padding:16px 20px; }

/* Tasks page */
.tasks-wrap{ display:grid; grid-template-columns: 280px 1fr; gap:24px; height:calc(100vh - 108px); overflow:hidden; }
.tasks-projects{ height:100%; overflow:auto; }
.tasks-board{ height:100%; display:flex; flex-direction:column; overflow:hidden; }
.tasks-header{ display:flex; align-items:center; justify-content:center; gap:12px; padding:0 8px 12px; }
.tasks-header .range{ min-width:220px; text-align:center; font-weight:600; }

.week-grid{ flex:1; overflow:hidden; border:1px solid #e5e7eb; border-radius:12px; background:#fff; display:grid; grid-template-columns: repeat(7, 1fr); }
.day-col{ border-left:1px solid #f1f5f9; display:flex; flex-direction:column; min-width:0; }
.day-col:first-child{ border-left:0; }
.day-head{ padding:10px 12px; border-bottom:1px solid #f1f5f9; font-weight:600; display:flex; justify-content:space-between; align-items:center; }
.day-body{ position:relative; padding:10px; overflow:auto; }
.add-on-hover{ opacity:0; transition:opacity .12s ease; }
.day-col:hover .add-on-hover{ opacity:1; }

.task-card{ background:#f8fafc; border:1px solid #e2e8f0; border-radius:10px; padding:10px 12px; font-size:13px; line-height:1.25; margin-bottom:8px; cursor:grab; }
.task-card:active{ cursor:grabbing; }

/* Hover effects for grid cells */
.finance-grid .finance-cell:hover .cell-btn{ background:#f8fafc; border-color:#e2e8f0; }
.btn.btn-xs { padding: 6px 10px; font-size: 12px; border-radius: 8px; }

/* Dropdowns & Context menus */
.dd-backdrop, .ctx-backdrop{
  position: fixed; inset: 0; background: transparent; z-index: 999;
}
.dd-menu, .ctx-menu{
  position: fixed; z-index: 1000; 
  background: #ffffff; 
  border: 1px solid #d1d5db; 
  border-radius: 8px; 
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  min-width: 200px;
  max-width: 300px;
  padding: 8px 0;
  /* Hide scrollbars but allow scrolling */
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.dd-menu::-webkit-scrollbar, .ctx-menu::-webkit-scrollbar {
  display: none;
}
.dd-menu.full{ min-width: 220px; }
.dd-item, .ctx-item{
  padding: 12px 16px; 
  font-size: 14px; 
  font-weight: 500;
  cursor: pointer;
  color: #374151;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  gap: 8px;
}
.dd-item:hover, .ctx-item:hover{ 
  background: #f3f4f6; 
  color: #111827;
}
.ctx-item:active {
  background: #e5e7eb;
}

/* Form controls */
.label{display:block;font-weight:600;margin-bottom:6px;color:#0f172a;}
.input{display:block;width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;color:#0f172a;outline:none;}
.input:focus{border-color:var(--primary); box-shadow:0 0 0 4px var(--ring);}
.textarea{display:block;width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;color:#0f172a;outline:none;resize:vertical;}
.textarea:focus{border-color:var(--primary); box-shadow:0 0 0 4px var(--ring);}
.btn-sm{padding:8px 12px; font-size:12px}
.btn-lg{padding:14px 18px; font-size:14px}

/* Remove hover effects from dropdown arrows and select elements */
select:hover,
select:focus,
.dd-btn:hover span:last-child,
.dd-btn:focus span:last-child,
.dd-btn span:last-child:hover {
  background: transparent !important;
  color: inherit !important;
}

/* Hide scrollbars in all select elements and dropdowns */
select,
.dd-menu,
.ctx-menu,
[role="listbox"],
[role="menu"] {
  scrollbar-width: none;
  -ms-overflow-style: none;
}

select::-webkit-scrollbar,
.dd-menu::-webkit-scrollbar,
.ctx-menu::-webkit-scrollbar,
[role="listbox"]::-webkit-scrollbar,
[role="menu"]::-webkit-scrollbar {
  display: none;
}

/* Cell editor styles from cell-editor.css */
.editor-modal { position: fixed; inset: 0; z-index: 50; display:flex; align-items:center; justify-content:center; padding:16px; }
.editor-backdrop { position:absolute; inset:0; background: rgba(0,0,0,.4); }
.editor-card { position:relative; background:#ffffff; border-radius:16px; box-shadow: 0 20px 60px rgba(0,0,0,.15); width:100%; max-width:720px; overflow:hidden; }

.editor-header, .editor-footer { padding:0; background:#fff; }
.editor-header { font-size:16px; font-weight:600; }
.editor-sub { font-size:12px; color:#64748b; margin-top:2px; }

.editor-divider { height:1px; width:100%; background:#e5e7eb; }

.editor-body { position:relative; padding:0; background:#fff; min-height:220px; }
.editor-body .loading-overlay { position:absolute; inset:0; background:rgba(255,255,255,.6); display:flex; align-items:center; justify-content:center; font-size:13px; color:#334155; }

/* add form */
.editor-add { display:flex; gap:8px; margin-bottom:12px; }
.editor-input { border:1px solid #e5e7eb; border-radius:10px; padding:8px 10px; font-size:13px; }
.editor-input:focus { outline:none; border-color:#2563eb; box-shadow:0 0 0 3px rgba(37,99,235,.12); }
.editor-input.number { width:140px; }
.editor-input.text { flex:1; }

/* entries list */
.entry-row { display:flex; align-items:center; gap:10px; border:1px solid #e5e7eb; background:#f8fafc; border-radius:10px; padding:8px 10px; }
.entry-row + .entry-row { margin-top:8px; }
.entry-drag { width:18px; height:18px; display:flex; align-items:center; justify-content:center; color:#94a3b8; cursor:grab; }
.entry-left { display:flex; align-items:center; gap:8px; }
.entry-amount { width:120px; text-align:right; }
.entry-note { flex:1; }

.entry-remove { color:#b91c1c; font-size:13px; }
.entry-remove:hover { text-decoration:underline; }

/* custom checkbox */
.chk { position:relative; width:18px; height:18px; }
.chk input { position:absolute; inset:0; opacity:0; }
.chk .box { width:18px; height:18px; border-radius:6px; border:1px solid #cbd5e1; background:#fff; display:flex; align-items:center; justify-content:center; transition: all .12s; }
.chk input:checked + .box { background:#2563eb; border-color:#2563eb; }
.chk .icon { width:12px; height:12px; opacity:0; transform:scale(.7); transition: all .12s; color:#fff; }
.chk input:checked + .box .icon { opacity:1; transform:scale(1); }

/* transparent when unchecked */
.entry-disabled { opacity:.5; }

/* footer buttons */
.btn { 
  border-radius: 8px; 
  padding: 8px 12px; 
  font-size: 14px; 
  font-weight: 500;
  line-height: 1.4;
  border: 1px solid #e5e7eb; 
  background: #fff; 
}
.btn:hover { background: #f8fafc; }
.btn-primary { 
  background: #111827; 
  color: #fff; 
  border-color: #111827; 
  font-weight: 500;
}
.btn-primary:hover { background: #0f172a; }

/* Remove number spinners */
input[type='number']::-webkit-outer-spin-button,
input[type='number']::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
input[type='number'] { -moz-appearance: textfield; }

/* ===== TYPOGRAPHY SYSTEM ===== */
/* H1 - Page titles */
h1, .text-h1 {
  font-size: 24px;
  font-weight: 700;
  line-height: 1.2;
  margin: 0 0 16px 0;
}

/* H2 - Section/Card titles */
h2, .text-h2 {
  font-size: 18px;
  font-weight: 600;
  line-height: 1.3;
  margin: 0 0 12px 0;
}

/* H3 - Subsection titles */
h3, .text-h3 {
  font-size: 16px;
  font-weight: 600;
  line-height: 1.4;
  margin: 0 0 8px 0;
}

/* Base text - Tables, paragraphs, body content */
p, .text-base, .text-body {
  font-size: 14px;
  font-weight: 400;
  line-height: 1.5;
  margin: 0 0 8px 0;
}

/* Buttons, tabs, navigation */
button, .btn, .text-button, .nav-item {
  font-size: 14px;
  font-weight: 500;
  line-height: 1.4;
}

/* Small text, labels, captions */
.text-sm, .text-caption, .text-label {
  font-size: 12px;
  font-weight: 400;
  line-height: 1.4;
}

/* Mobile responsive typography */
@media (max-width: 768px) {
  body {
    font-size: 16px; /* Better accessibility on mobile */
  }
  
  h1, .text-h1 {
    font-size: 22px;
  }
  
  h2, .text-h2 {
    font-size: 18px;
  }
  
  h3, .text-h3 {
    font-size: 16px;
  }
  
  p, .text-base, .text-body {
    font-size: 16px;
  }
  
  button, .btn, .text-button, .nav-item {
    font-size: 16px;
  }
  
  .text-sm, .text-caption, .text-label {
    font-size: 14px;
  }
}

/* Typography utilities for consistent spacing */
.text-spacing-tight { line-height: 1.2; }
.text-spacing-normal { line-height: 1.5; }
.text-spacing-loose { line-height: 1.6; }

/* Font weight utilities */
.font-regular { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }
