import{s as g,j as e}from"./index-opaSS7ow.js";import{r as a}from"./vendor-CqGws4Uo.js";import{D as j,g as N}from"./auth-CvP6sRS5.js";import"./supabase-BmeMSZYH.js";function A(){const[d,u]=a.useState([]),[f,l]=a.useState(!0),[n,c]=a.useState(null);return a.useEffect(()=>{let s=!1;return(async()=>{l(!0),c(null);try{const t=j.notes;let r=g.from(t.table).select(`${t.id},${t.title},${t.updatedAt}`);const o=t.userId,m=await N();o&&m&&(r=r.eq(o,m));const{data:h,error:x}=await r.order(t.updatedAt,{ascending:!1}).limit(6);if(x)throw x;const p=h.map(i=>({id:i[t.id],title:i[t.title],updatedAt:i[t.updatedAt]}));s||u(p)}catch(t){s||c(t?.message||"Ошибка загрузки заметок")}finally{s||l(!1)}})(),()=>{s=!0}},[]),e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold tracking-[-0.01em]",children:"Последние заметки"}),e.jsx("a",{href:"/notes",className:"text-sm text-blue-600 hover:underline",children:"Все заметки"})]}),f?e.jsx("div",{className:"text-sm text-gray-500",children:"Загрузка…"}):n?e.jsxs("div",{className:"text-sm text-red-600",children:["Ошибка: ",n]}):d.length===0?e.jsx("div",{className:"text-sm text-gray-500",children:"Заметок нет."}):e.jsx("ul",{className:"space-y-2",children:d.slice(0,3).map(s=>e.jsxs("li",{className:"flex items-center justify-between rounded-xl border border-gray-100 p-3 hover:bg-gray-50",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm",children:s.title||"Без названия"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Обновлено ",new Date(s.updatedAt).toLocaleString("ru-RU")]})]}),e.jsx("a",{className:"btn",href:`/notes?id=${s.id}`,children:"Открыть"})]},s.id))})]})}export{A as RecentNotes};
