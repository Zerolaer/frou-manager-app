import{s as j,j as e}from"./index-BJakucwa.js";import{r as a}from"./vendor-5APVzNZg.js";import{D as N,g}from"./auth-BKPcReOB.js";import"./supabase-7cNBIxai.js";function A(){const[l,x]=a.useState([]),[f,n]=a.useState(!0),[c,d]=a.useState(null);return a.useEffect(()=>{let s=!1;return(async()=>{n(!0),d(null);try{const t=N.notes;let i=j.from(t.table).select(`${t.id},${t.title},${t.updatedAt}`);const m=t.userId,o=await g();m&&o&&(i=i.eq(m,o));const{data:h,error:u}=await i.order(t.updatedAt,{ascending:!1}).limit(6);if(u)throw u;const p=h.map(r=>({id:r[t.id],title:r[t.title],updatedAt:r[t.updatedAt]}));s||x(p)}catch(t){s||d(t?.message||"Ошибка загрузки заметок")}finally{s||n(!1)}})(),()=>{s=!0}},[]),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Последние заметки"}),e.jsx("a",{href:"/notes",className:"text-sm text-primary hover:underline",children:"Все заметки"})]}),f?e.jsx("div",{className:"text-sm text-neutral-500",children:"Загрузка…"}):c?e.jsxs("div",{className:"text-sm text-danger",children:["Ошибка: ",c]}):l.length===0?e.jsx("div",{className:"text-sm text-neutral-500",children:"Заметок нет."}):e.jsx("ul",{className:"space-y-2",children:l.slice(0,3).map(s=>e.jsxs("li",{className:"flex items-center justify-between card-compact hover:bg-neutral-50",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"truncate text-sm",children:s.title||"Без названия"}),e.jsxs("div",{className:"text-xs text-neutral-500",children:["Обновлено ",new Date(s.updatedAt).toLocaleString("ru-RU")]})]}),e.jsx("a",{className:"btn btn-sm",href:`/notes?id=${s.id}`,children:"Открыть"})]},s.id))})]})}export{A as RecentNotes};
