import{j as e,A as a}from"./index-VPEx-n7V.js";import{r as d}from"./vendor-5APVzNZg.js";class x extends d.Component{retryTimeoutId=null;constructor(r){super(r),this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,t){const{pageName:i,onError:s,maxRetries:n=3}=this.props,{retryCount:o}=this.state;console.error(`Error in ${i}:`,r,t),s?.(r,t),o<n&&(this.retryTimeoutId=setTimeout(()=>{this.setState(l=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:l.retryCount+1}))},Math.pow(2,o)*1e3))}componentWillUnmount(){this.retryTimeoutId&&clearTimeout(this.retryTimeoutId)}handleRetry=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:this.state.retryCount+1})};handleReset=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:0})};render(){if(this.state.hasError){const{pageName:r,fallback:t}=this.props,{error:i,retryCount:s}=this.state;return t||e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"text-red-500 text-2xl",children:"⚠️"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-red-600",children:["Ошибка в ",r]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Произошла неожиданная ошибка. Попробуйте обновить страницу."})]})]}),!1,e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{variant:"primary",size:"sm",onClick:this.handleRetry,ariaLabel:`Попробовать снова (попытка ${s+1})`,children:"Попробовать снова"}),e.jsx(a,{variant:"secondary",size:"sm",onClick:this.handleReset,ariaLabel:"Сбросить и начать заново",children:"Сбросить"}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>window.location.reload(),ariaLabel:"Обновить страницу",children:"Обновить страницу"})]}),s>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Попытка ",s," из 3"]})]})})}return this.props.children}}export{x as P};
