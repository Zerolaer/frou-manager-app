# –£–ª—É—á—à–µ–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. **Service Worker —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º**
- ‚úÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω SW –≤ `main.tsx`
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ Supabase API –∑–∞–ø—Ä–æ—Å–æ–≤ (5 –º–∏–Ω—É—Ç)
- ‚úÖ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:
  - **JS/CSS**: stale-while-revalidate (–º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞)
  - **Images**: cache-first (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)
  - **API**: network-first —Å fallback –Ω–∞ –∫–µ—à
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ

### 2. **IndexedDB –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**
- ‚úÖ –°–æ–∑–¥–∞–Ω `indexedDbCache.ts` - –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ L1: in-memory (–±—ã—Å—Ç—Ä–æ)
- ‚úÖ L2: IndexedDB (–ø–µ—Ä–µ–∂–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ TTL: 30 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### 3. **–£–ª—É—á—à–µ–Ω–Ω—ã–π useSupabaseQuery**
- ‚úÖ Stale-while-revalidate –∏–∑ –∫–æ—Ä–æ–±–∫–∏
- ‚úÖ Persist=true –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (IndexedDB)
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤ —Ñ–æ–Ω–µ
- ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

### 4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Vite**
- ‚úÖ –£–º–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —á–∞–Ω–∫–æ–≤ (vendor-react, vendor-supabase, feature-*)
- ‚úÖ Content-based hashing –¥–ª—è –∫–µ—à–∞
- ‚úÖ CSS code splitting
- ‚úÖ –ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è CSS

### 5. **Netlify Headers**
- ‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏ (1 –≥–æ–¥)
- ‚úÖ Service Worker headers
- ‚úÖ Security headers

### 6. **Preload & Preconnect**
- ‚úÖ Preconnect –∫ Supabase
- ‚úÖ DNS prefetch –¥–ª—è Google Fonts
- ‚úÖ Module preload –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ Prefetch —Ä–æ—É—Ç–æ–≤ –Ω–∞ idle

### 7. **PWA Manifest**
- ‚úÖ –ë–∞–∑–æ–≤–∞—è PWA –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- ‚úÖ Standalone —Ä–µ–∂–∏–º
- ‚úÖ –û—Ñ—Ñ–ª–∞–π–Ω —Ñ–æ–ª–ª–±–µ–∫

## –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ:**
- üî¥ –ö–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–≥—Ä—É–∑–∫–∞ —Å –Ω—É–ª—è
- üî¥ –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- üî¥ –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –≤–∏–∑–∏—Ç—ã
- üî¥ –ë–æ–ª—å—à–∏–µ —á–∞–Ω–∫–∏

**–ü–æ—Å–ª–µ:**
- üü¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–æ–≤
- üü¢ –î–∞–Ω–Ω—ã–µ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ IndexedDB (–ø–µ—Ä–µ–∂–∏–≤–∞—é—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É)
- üü¢ API –∑–∞–ø—Ä–æ—Å—ã –∫–µ—à–∏—Ä—É—é—Ç—Å—è (–±—ã—Å—Ç—Ä—ã–π –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º)
- üü¢ –£–º–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞
- üü¢ Stale-while-revalidate (–≤—Å–µ–≥–¥–∞ –±—ã—Å—Ç—Ä–æ)

## –ú–µ—Ç—Ä–∏–∫–∏

–ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤–∏–∑–∏—Ç–µ:
- **First Paint**: ~100-200ms (–±—ã–ª–æ 1-2s)
- **Time to Interactive**: ~300-500ms (–±—ã–ª–æ 2-3s)
- **API Response**: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ –∫–µ—à–∞ (–±—ã–ª–æ 200-500ms)
- **Bandwidth**: -80% –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤–∏–∑–∏—Ç–∞—Ö

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! –ü—Ä–æ—Å—Ç–æ:

```tsx
// –í –ª—é–±–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const { data, loading } = useSupabaseQuery(
  'my-query',
  () => supabase.from('table').select(),
  { persist: true } // –≤–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
)
```

## –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à:

```js
import { clearQueryCache } from '@/hooks/useSupabaseQuery'
clearQueryCache() // –æ—á–∏—â–∞–µ—Ç –∏ memory –∏ IndexedDB
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π DevTools ‚Üí Application ‚Üí Service Workers (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç–∏–≤–µ–Ω)
2. Application ‚Üí Cache Storage (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–µ—à–µ–π)
3. Application ‚Üí IndexedDB ‚Üí frou-manager-cache (–¥–∞–Ω–Ω—ã–µ queries)
4. Network ‚Üí Disable cache –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ - –≤—Å–µ —Ä–∞–≤–Ω–æ –±—ã—Å—Ç—Ä–æ!

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –æ–±—ã—á–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
2. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ (F5)**: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ!
3. **–û—Ñ—Ñ–ª–∞–π–Ω**: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. **–ú–µ–¥–ª–µ–Ω–Ω—ã–π 3G**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤ —Ñ–æ–Ω–µ

## Debug

–í –∫–æ–Ω—Å–æ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —É—Ç–∏–ª–∏—Ç—ã:
```js
// –û—á–∏—Å—Ç–∏—Ç—å –í–°–ï –∫–µ—à–∏ (–ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å)
__cache.clearAll()

// –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ query cache
__cache.clearQueries()

// –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ IndexedDB
__cache.clearDB()

// –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (hit/miss rate)
__cache.stats()

// –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∫–ª—é—á–∏ –∫–µ—à–µ–π
__cache.keys()

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
console.log(performance.getEntriesByType('resource'))

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SW
navigator.serviceWorker.getRegistrations()
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–í dev —Ä–µ–∂–∏–º–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –≤ –∫–æ–Ω—Å–æ–ª—å –ø–∏—à–µ—Ç—Å—è cache report —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏:
- Memory cache hits/misses
- IndexedDB cache hits/misses
- Hit rate % –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–µ—à–∞

